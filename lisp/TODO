TODO      [Time-stamp: "2002-04-18 22:40:51 lenst"]           -*- outline -*- 


* Rewrite sgml-popup-multi-menu

Should also split the menu if larger than sgml-max-menu-size.
Construct the menu as a keymap.

What about XEmacs?


* Cosider removing sgml-balanced-tag-edit
Only affects sgml-tag-menu.
Perhaps replace with a "context menu type" option.

* Restore window config after edit-attr

* Indent and fill

Should probably not indent in NOFILL elements.

Perhaps indentation in a fillable element should be the same for all
lines. That would speed up fill. Exception for non-fillable elements
inside fillable elements (like list in paragraphs), these sould be
indented independently.

Make indentation algorithm pluggable.

sgml-compute-indent ELEMENT PART  =>  COLUMN

PART in stag, etag, content, attribute ?

Help func: sgml-current-indent-of ELEMENT => COLUMN

(sgml-compute-indent e 'content) ->
        (sgml-current-indent-of e) + sgml-ident-step

(sgml-compute-indent e 'stag) ->
        (sgml-current-indent-of (sgml-element-parent e)) + sgml-ident-step
or is this always =
   (sgml-compute-indent (sgml-element-parent e) 'content)




* sgml-kill-element

if there is no following element, kill up to the end tag of the
current element.

* sgml-do-data - needs a better docstring

* Set-faces has other variables sensible defaults

sgml-auto-activate-dtd

* Fix documentation of sgml-display-char-list-filename

File format is not properly descibed.

* sgml-parse-prolog

Should perhaps respect sgml-parent-document

* Konstigt beteende när DOCTYPE specar en odefinierad elementtyp,
speciellt om det är nästan samma som topelementet i instansen men
skiljer sig i case.

* Change sgml-throw-on-warning to be a handler

I.e. instead of throwing call a handler hook.
The handler can then do the throw if that is desirable.

* Kanske sgml--add-before-p borde användas allmänt

T.ex. av sgml-insert-element

* Kolla #REQUIRED attribut

i sgml-parse-attribute-specification-list

    ;; Check all required attributes specified
    (let ((unspecified
           (loop for attdecl in attlist
                 if (and (sgml-default-value-type-p
                          'REQUIRED (sgml-attdecl-default-value attdecl))
                         (not (sgml-lookup-attspec (sgml-attdecl-name attdecl)
                                                   asl)))
                 collect attdecl)))
      (when unspecified
        (sgml-log-warning "Missing required attributes: %s"
                          (mapcar (function sgml-attdecl-name) unspecified))))


måste också plocka bort optimering av start-tag utan asl.

Hur mycket är funktionalliteten värd? Vad kostar den? 

* Determining legal elements

If the current element has valid content, then only elements that does
not make the current element invalid is legal.

If current element has invalid content, then ??

If current element has no end tag, and OMITTAG is on. Consider
elements legal after this element if the current position is last in
the element.

Possibly clean up old functions and variables like
sgml-omittag-transparent and sgml-insert-tag.

* Parsing start-tag

Parse the different consituents of the start tag without reference to
the DTD. If the tag is well-formed then check it against the DTD. If
this is XML w/o a DTD, adjust the constructed DTD to allow the element
and attributes.

Consequences for SGML: parse attspec does not always identify
attributes. The check against the DTD will fill in attribute names for
attributes specified with a value only. This is also the time to check
for CONREF and check that all required attributes are given.

