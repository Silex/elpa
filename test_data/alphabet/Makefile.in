# -*- mode: makefile; coding: utf-8 -*-
#	$Id: Makefile.in,v 1.7 2019/01/07 05:27:54 doug Exp $	

# Copyright Â© 2019 Free Software Foundation, Inc.
# All rights reserved.
# 
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

PROJECT		=	@PACKAGE_NAME@
PROJECT_VERSION	=	@PACKAGE_VERSION@

################################
# 
# What we're building
# 
CFILES		=	
HFILES		=	
OFILES		=	${CFILES:.o=.c}


SHELLS		=	
EL_FILES	=	
SRC_FILES	=	Makefile.in

################################
# 
# Where things are
# 
prefix		=	@prefix@
distdir		=	${top_srcdir}/${PROJECT}-${PROJECT_VERSION}/test_data/alphabet

# And where they go
bindir		=	${prefix}/bin
docdir		=	${prefix}/share/doc
exec_prefix	=	${prefix}
execdir		=	${exec_prefix}
libdir		=	${exec_prefix}/lib
libexecdir	=	${exec_prefix}/libexec
sbindir		=	${exec_prefix}/sbin

datarootdir	=	${prefix}/share
datadir		=	${datarootdir}
infodir		=	${datarootdir}/info
sysconfdir	=	${prefix}/etc
sharedstatedir	=	${prefix}/com
localstatdir	=	${prefix}/var
runstatedir	=	${localstatdir}/run

includedir	=	${prefix}/include
oldincludedir	=	/usr/include
docdir		=	@docdir@
infodir		=	@infodir@
htmldir		=	${docdir}
dvidir		=	${docdir}
pdfdir		=	${docdir}
psdir		=	${docdir}
libdir		=	${exec_prefix}/lib
lispdir		=	${prefix}/share/${PROJECT}/${PROJECT_VERSION}/lisp
localedir	=	${datarootdir}/locale
mandir		=	${datarootdir}/man
man1dir		=	${mandir}/man1
man2dir		=	${mandir}/man2
man3dir		=	${mandir}/man3
man4dir		=	${mandir}/man4
man5dir		=	${mandir}/man5
man6dir		=	${mandir}/man6
man7dir		=	${mandir}/man7
manext		=	.1
man1ext		=	.1
man2ext		=	.2
man3ext		=	.3
man4ext		=	.4
man5ext		=	.5
man6ext		=	.6
man7ext		=	.7
srcdir		=	@srcdir@
abs_srcdir	=	@abs_srcdir@
top_srcdir	=	@top_srcdir@

################################
# 
# Distribution information
# 
TAR_OPTS	=	@tar_opts@
TAR_SUFFIX	=	@tar_suffix@

TARBALL		=	${PROJECT}-${PROJECT_VERSION}-${shell date +%Y%m%d%H%M%S}.${TAR_SUFFIX}


################################
# 
# Programs we use
# 

INSTALL	=	@INSTALL@
CC	=	@CC@
CFLAGS	=	


################################
#
# Keys for building test data.
# 
LETTERS	=	a b c d e f g h i j k l m n o p q r s t u v w x y z


################################################################

################################
# 
# Building
# 

.PHONY: default help all alphabet nonsense check_gnu

default:	check_gnu
	@echo "This Makefile has no defaults."
	@echo "Please type one of the archive format targets:"
	@echo "    ${MAKE} all"
	@echo "    ${MAKE} bin"
	@echo "    ${MAKE} crc"
	@echo "    ${MAKE} hpbin"
	@echo "    ${MAKE} hpodc"
	@echo "    ${MAKE} newc"
	@echo "    ${MAKE} odc"
	@echo "    ${MAKE} tar"
	@echo "    ${MAKE} ustar"
	@echo "instead."

help:	check_gnu	default

nonsense:
	@echo "The target [[${@}]] does not make sense in this directory."

check_gnu:
	@${MAKE} --version >/dev/null 2>&1 || ( echo "This makefile requires GNU Make." && exit 1 )

.PHONY: alphabet ${LETTERS}

alphabet: check_gnu ${LETTERS}

small_alphabet: check_gnu a b c

${LETTERS}:
	@for i in ${@} ${@}${@} ${@}${@}${@} ${@}${@}${@}${@} ${@}${@}${@}${@}${@} ; do	\
		>  $${i} ; 								\
		echo       >> $${i} ; 							\
		echo $${i} >> $${i} ; 							\
		echo       >> $${i} ; 							\
	done
	@if ! [ -d ${@}${@}${@}${@}${@}.d ] ; then 					\
		mkdir ${@}${@}${@}${@}${@}.d ; 						\
	fi

################################
#
# Cpio formats
#
.PHONY: all bin crc hpbin hpodc newc odc tar ustar
all: bin crc hpbin hpodc newc odc tar ustar links
# Yes, these regular expressions are a little brittle,
# but they work in this directory.
archives:
	ls -1 -d ? ?? ??? ???? ????? ?????.d | grep -v CVS | cpio -o -H ${archive_format} > alphabet.${archive_format}.cpio
	ls -1 -d a aa aaa aaaa aaaaa aaaaa.d b bb bbb bbbb bbbbb bbbbb.d c cc ccc cccc ccccc ccccc.d | cpio -o -H ${archive_format} > alphabet_small.${archive_format}.cpio
	ls -1 -d a aa aaaaa.d b bb | cpio -o -H ${archive_format} > alphabet_tiny.${archive_format}.cpio
	ls -1 -d a aaaaa.d | cpio -o -H ${archive_format} > alphabet_mini.${archive_format}.cpio

bin crc hpbin hpodc newc odc tar ustar: alphabet
	${MAKE} archive_format=${@} archives

links:	# bin_links crc_links hpbin_links hpodc_links newc_links tar_links ustar_links
	for i in *.cpio ; do 				\
		ln -s $${i} `basename $${i} .cpio` ; 	\
	done

################################
# 
# Testing
# 

check: nonsense

installcheck: nonsense

.PHONY: check_copyrights
check_copyrights: ${SRC_FILES}
	@EXIT=0 ; 								\
	for f in ${SRC_FILES} ; do						\
		if grep -q -i copyright $${f} ; then 				\
			: ; 							\
		else 								\
			echo "$${f} looks like it is missing a copyright" ; 	\
			EXIT=1 ; 						\
		fi ; 								\
	done ; 									\
	exit ${EXIT}

################################
# 
# Installation
# 

install:	nonsense

installdirs:	nonsense

uninstall:	nonsense

install-html:	nonsense
install-dvi:	nonsense
install-pdf:	nonsense
install-ps:	nonsense
install-strip:	nonsense


################################
# 
# Hygiene
# 

clean:
	-rm *.cpio
	-for l in ${LETTERS} ; do									\
		rm $${l} $${l}$${l} $${l}$${l}$${l} $${l}$${l}$${l}$${l} $${l}$${l}$${l}$${l}$${l} ; 	\
		rmdir $${l}$${l}$${l}$${l}$${l}.d ; 							\
	done
	for i in * ; do 										\
		if [ -L $${i} ] ; then 									\
			rm -f $${i} ; 									\
		fi ; 											\
	done


distclean: clean
	-rm -f *~

mostlyclean: clean

maintainer-clean: distclean


################################
# 
# Documentation
# 

dvi:	nonsense

html:	nonsense

pdf:	nonsense

ps:	nonsense

################################
# 
# Distribution
# 

dist:	check_gnu distdir
	${INSTALL} Makefile.in ${distdir}

distdir:	check_gnu
	test -d ${distdir} || mkdir -p ${distdir}

################################
# 
# Miscellany
# 

info:	nonsense

################
# 
# Autoreconfiscation.
# 

${top_srcdir}/configure: ${top_srcdir}/configure.ac # aclocal.m4
	cd '${top_srcdir}' && autoconf

# autoheader might not change config.h.in, so touch a stamp file.
# ${top_srcdir}/config.h.in: stamp-h.in
${top_srcdir}/stamp-h.in: ${top_srcdir}/configure.ac # aclocal.m4
	cd '${top_srcdir}' # && autoheader
	echo timestamp > '${top_srcdir}/stamp-h.in'

${top_srcdir}/config.h: ${top_srcdir}/stamp-h
${top_srcdir}/stamp-h: ${top_srcdir}/config.h.in ${top_srcdir}/config.status
	cd '${top_srcdir}' ; 		\
	./config.status

Makefile: Makefile.in ${top_srcdir}/config.status
	cd '${top_srcdir}' ; 		\
	./config.status

${top_srcdir}/config.status: ${top_srcdir}/configure
	cd '${top_srcdir}' ; 		\
	./config.status --recheck
